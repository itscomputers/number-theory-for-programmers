<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>number theory for programmers</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="sections/divisibility.html"><strong aria-hidden="true">1.</strong> divisibility</a></li><li class="chapter-item expanded "><a href="sections/division_with_remainder.html"><strong aria-hidden="true">2.</strong> division with remainder</a></li><li class="chapter-item expanded "><a href="sections/greatest_common_divisor.html"><strong aria-hidden="true">3.</strong> greatest common divisor</a></li><li class="chapter-item expanded "><a href="sections/bezouts_identity.html"><strong aria-hidden="true">4.</strong> bezout's identity</a></li><li class="chapter-item expanded "><a href="sections/least_common_multiple.html"><strong aria-hidden="true">5.</strong> least common multiple</a></li><li class="chapter-item expanded "><a href="sections/linear_equations.html"><strong aria-hidden="true">6.</strong> linear equations</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">number theory for programmers</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#divisibility" id="divisibility">divisibility</a></h1>
<p>This study of integers begins with the notion of divisibility: whether the
division of two integers results in an integer.  Because of the volatile nature
of division, we frame this question in terms of integer multiplication.</p>
<blockquote>
<p>A nonzero integer \( b \) <strong>divides</strong> an integer \( a \) if there exists
some integer \( n \) such that \( a = bn \).</p>
</blockquote>
<p>Here are a few examples:</p>
<ul>
<li>15 divides 45 since \( 45 = 15 \cdot 3 \)</li>
<li>9 divides 45 since \( 45 = 9 \cdot 5 \)</li>
<li>10 does not divide 45 since 45 is between
\( 40 = 10 \cdot 4 \) and \( 50 = 10 \cdot 5 \)</li>
</ul>
<p>The above definition is synonymous with saying that \( b \)
may be expressed as a multiple of \( a \).  In fact, the following
statements are equivalent and mean that \( a \) is can be expressed as
\( bn \).</p>
<ul>
<li>\( b \) divides \( a \)</li>
<li>\( b \) is a divisor of \( a \)</li>
<li>\( a \) is divisible by \( b \)</li>
<li>\( a \) is a multiple of \( b \)</li>
</ul>
<p>The notation for this concept is \( b \mid a \), which reads &quot;\( b \)
divides \( a \)&quot;.  Using this notation, the examples above become:</p>
<ul>
<li>\( 15 \mid 45 \) since \( 45 = 15 \cdot 3 \)</li>
<li>\( 9 \mid 45 \) since \( 45 = 9 \cdot 5 \)</li>
<li>\( 10 \nmid 45 \) since \( 10 \cdot 4 &lt; 45 &lt; 10 \cdot 5 \)</li>
</ul>
<p>Be careful!  This notation may sometimes be confused with the division
operation. If you see \( 15 / 45 \), it is the operation that returns
the rational number \( 1/3 \).  If you see \( 15 \mid 45 \), it is the
statement that \( 45 \) is divisible by \( 15 \), ie, that \( 45 / 15 \)
is an integer.</p>
<span id="divides-exercise" />
<blockquote>
<p><strong>exercise.</strong>
Using <strong>only</strong> addition, multiplication, and comparison, write a <code>divides</code>
function that takes as input two <em>positive</em> integers <code>b</code> and <code>a</code> and returns
<code>true</code> if <code>b</code> divides <code>a</code> and <code>false</code> otherwise.</p>
</blockquote>
<p>With such a <code>divides?</code> function in ruby, the following code should yield the
terminal output below.</p>
<pre><code class="language-ruby">  [
    [25, 0],
    [31, 432],
    [87, 87*58],
    [99, 9900],
    [9900, 99],
  ].each do |(b, a)|
    if divides?(b, a)
      puts &quot;#{b} divides #{a}&quot;
    else
      puts &quot;#{b} does not divide #{a}&quot;
    end
  end
</code></pre>
<pre><code>25 divides 0
31 does not divide 432
87 divides 5046
99 divides 9900
9900 does not divide 99
</code></pre>
<p>Click the button below to show an implementation of a simple <code>divides?</code>
function in ruby.</p>
<p><button class="fa fa-expand" onClick="showContent('divides')"></button></p>
<div id="divides" style="display: none;">
<pre><code class="language-ruby">def divides?(b, a)
  m = 0
  while m &lt; a
    m += b
  end

  m == a
end
</code></pre>
</div>
<h2><a class="header" href="#linear-combinations" id="linear-combinations">linear combinations</a></h2>
<blockquote>
<p>An <strong>integer linear combination</strong> of integers \( a \) and \( b \) is an
integer of the form \( ax + by \) where \( x \) and \( y \) are integers.</p>
</blockquote>
<p>For example, 11 through 15 can all be expressed as linear
combinations of 5 and 6.  Here are two examples of each.</p>
<p>\[\begin{align}
5(1) + 6(1) &amp;= 11 = 5(7) + 6(-4) \\
5(0) + 6(2) &amp;= 12 = 5(6) + 6(-3) \\
5(-1) + 6(3) &amp;= 13 = 5(5) + 6(-2) \\
5(-2) + 6(4) &amp;= 14 = 5(4) + 6(-1) \\
5(-3) + 6(5) &amp;= 15 = 5(3) + 6(0) \\
\end{align}\]</p>
<p>The following proposition about integer linear combinations will be used
often.</p>
<span id="linear-combination" />
<blockquote>
<p><strong>proposition 1.</strong>
If \( d \) is a common divisor of \( a \) and \( b \), then \( d \)
divides any integer linear combination of \( a \) and \( b \).</p>
</blockquote>
<blockquote>
<p><em>proof:</em>
Suppose that \( d \) divides \( a \) and \( b \).  By definition, there
exist integers \( m, n \) such that \( a = dm \) and \( b = dn \).  Let
\( c = ax + by \) be an integer linear combination of \( a \) and
\( b \).  For any linear combination \( ax + by \),
\[ ax + by = (dm)x + (dn)y = d(mx + ny). \]
Since \( mx + ny \) is an integer, the linear combination is divisible by
\( d \).</p>
</blockquote>
<span id="exercises" />
<h2><a class="header" href="#exercises" id="exercises">exercises</a></h2>
<ol>
<li>
<p>Prove that any nonzero integer divides 0.</p>
</li>
<li>
<p>Prove that 1 and -1 divide any integer.</p>
</li>
<li>
<p>Prove that any nonzero integer divides itself.</p>
</li>
<li>
<p>If \( a \) and \( b \) are positive integers and \( b \) divides \( a
\), prove that \( b \le a \).</p>
</li>
<li>
<p>Prove that two positive integers that divide each other must be equal.</p>
</li>
<li>
<p>Prove that the <strong>divides</strong> relation is <em>transitive</em>: if \( c \mid b \) and
\( b \mid a \), prove that \( c \mid a \).</p>
</li>
<li>
<p>If \( d \) divides both \( a \) and \( b \), prove that \( d \)
divides their sum \( a + b \).</p>
</li>
<li>
<p>Disprove the converse of the previous exercise by producing a
counter-example.</p>
</li>
<li>
<p>If \( d \) divides either \( a \) or \( b \), prove that \( d \)
divides their product \( ab \).</p>
</li>
<li>
<p>Disprove the converse of the previous exercise by producing a
counter-example.</p>
</li>
</ol>
<p><button onClick="showContent('solutions')">show solutions</button></p>
<div id="solutions" style="display: none;">
<ol>
<li>
<p>For \( n \) nonzero, we have \( 0 = n \cdot 0 \), so \( n \) divides
\( 0 \).</p>
</li>
<li>
<p>For any \( n \), we have \( n = 1 \cdot n \) and \( n = -1 \cdot -n \),
so both \( 1 \) and \( -1 \) divide \( n \).</p>
</li>
<li>
<p>For \( n \) nonzero, we have \( n = n \cdot 1 \), so \( n \) divides
itself.</p>
</li>
<li>
<p>Let \( a \) and \( b \) be positive integers such that
\( b \mid a \).  Then \( a = bk \) for some integer \( k \).
Since \( a \) and \( b \) are both positive, then so is \ ( k \).
This means that \( k \ge 1 \), which implies that \( a = bk \ge b \).</p>
</li>
<li>
<p>Let \( a \) and \( b \) be two positive integers that divide each other.
From the previous exercise, we have \( a \le b \) and \( b \le a \), so
\( a \) and \( b \) must be equal.</p>
</li>
<li>
<p>Suppose that \( c \mid b \) and \( b \mid a \).  We can write
\( c = bm \) and \( b = an \).  Therefore, \( c = (an)m = a(mn) \),
which proves that \(c \mid a \).</p>
</li>
<li>
<p>Since the sum \( a + b \) is a linear combination of \( a \) and
\( b \), then the proposition implies that \( a + b \) is divisible by
any common divisor \( d \) of \( a \) and \( b \).</p>
</li>
<li>
<p>Take \( a = 3 \), \( b = 7 \), and \( d = 5 \).  Then \( d \)
divides the sum \( a + b = 10 \) but does not divide either \( a \) or
\( b \).</p>
</li>
<li>
<p>If \( d \) divides \( a \), then \( a = dn \), so \( ab = d(bn) \).
If \( d \) divides \( b \), then \( b = dm \), so \( ab = d(am) \).
Either way, \( d \) divides the product \( ab \).</p>
</li>
<li>
<p>Take \( a = 4 \), \( b = 3 \), and \( d = 6 \).  Then \( d \)
divides the product \( ab = 12 \) but does not divide either \( a \) or
\( b \).</p>
</li>
</ol>
</div>
<h1><a class="header" href="#division-with-remainder" id="division-with-remainder">division with remainder</a></h1>
<p>In the <a href="sections/./divisibility.html#divides-exercise">divides function</a> from the last
section, we employed a <code>while</code> loop.  The eventual termination of the loop
depends on the following principle.</p>
<blockquote>
<p><strong>Archimedes' principle.</strong>
For an integer \( a \) and a nonzero integer \( b \), there exists a
multiple of \( b \) which is greater than or equal to \( a \).</p>
</blockquote>
<p>This principle is equivalent to the <strong>division algorithm</strong>, which we will
prove.</p>
<span id="division-algorithm" />
<blockquote>
<p><strong>proposition 2 (division algorithm).</strong>
For an integer \( a \) and a nonzero integer \( b \), there are unique
integers \( q \) and \( r \) such that
\( a = bq + r \) and \( 0 \le r &lt; |b|. \)</p>
</blockquote>
<p>Terminology:</p>
<ul>
<li>\( a \) is called the <strong>dividend</strong>.</li>
<li>\( b \) is called the <strong>divisor</strong>.</li>
<li>\( q \) is called the <strong>quotient</strong>.</li>
<li>\( r \) is called the <strong>remainder</strong>.</li>
</ul>
<p>Before proving the division algorithm, here are a few examples.</p>
<ul>
<li>Dividing \( 71 \) by \( 20 \) gives \( 71 = 20(3) + 11 \)</li>
<li>Dividing \( 71 \) by \( -20 \) gives \( 71 = -20(-3) + 11  \)</li>
<li>Dividing \( -71 \) by \( 20 \) gives \( -71 = 20(-4) + 9 \)</li>
<li>Dividing \( -71 \) by \( -20 \) gives \( -71 = -20(4) + 9 \)</li>
</ul>
<blockquote>
<p><em>proof of division algorithm:</em>
If \( a \ge 0 \), consider the set \( S \), consisting of integers of
the form \( a - bn \) where \( n \) is an integer, ie,
\[ S = { a - bn: n \in \mathbf{Z} }. \]
The intersection of \( S \) the with nonnegative integers is non-empty,
since \( a \) itself is nonnegative. By the well-ordering principle, there
must be a unique smallest nonnegative element of \( S \), say
\( r = a - bq \).  Since \( r - |b| \) is a smaller element of \( S \),
it must be negative, hence \( r &lt; |b| \).</p>
<p>If \( a &lt; 0 \), then \( -a \) is positive, which was proven above to be
expressable as \( -a = bQ + R. \)  If \( R = 0 \), set \( q = -Q \) and
\( r = 0. \)  Otherwise, set \( r = -R + |b| \) and
\( q = -Q - |b| / b. \)  In either case, we have
\[ a = -bQ - R = bq + r \] with \( 0 \le r &lt; |b|. \)</p>
</blockquote>
<h2><a class="header" href="#in-code" id="in-code">in code</a></h2>
<p>In most programming languages, the implementation of a division and remainder
(modulus) operator likely will not match the specification given by the
division algorithm: when the dividend or divisor is negative, it may result in
a negative remainder.</p>
<p>In ruby, for example, integer division is floor division, so the quotient
<code>a / b</code> is computed by rounding down the rational number \( a / b \).
Therefore, the sign of the remainder <code>a % b</code> is the same as the sign of the
divisor <code>b</code>.</p>
<table><thead><tr><th align="right"><code>a</code></th><th align="right"><code>b</code></th><th align="right"><code>a / b</code></th><th align="right"><code>a % b</code></th></tr></thead><tbody>
<tr><td align="right"><code>71</code></td><td align="right"><code>20</code></td><td align="right"><code>3</code></td><td align="right"><code>11</code></td></tr>
<tr><td align="right"><code>71</code></td><td align="right"><code>-20</code></td><td align="right"><code>-4</code></td><td align="right"><code>-9</code></td></tr>
<tr><td align="right"><code>-71</code></td><td align="right"><code>20</code></td><td align="right"><code>-4</code></td><td align="right"><code>9</code></td></tr>
<tr><td align="right"><code>-71</code></td><td align="right"><code>-20</code></td><td align="right"><code>3</code></td><td align="right"><code>-11</code></td></tr>
</tbody></table>
<p>In rust, on the other hand, integer division is truncation, so the quotient
<code>a / b</code> is computed by rounding the rational number \( a / b \) toward zero.
Therefore, the sign of the remainder <code>a % b</code> is the same as the sign of the
dividend <code>a</code>.</p>
<table><thead><tr><th align="right"><code>a</code></th><th align="right"><code>b</code></th><th align="right"><code>a / b</code></th><th align="right"><code>a % b</code></th></tr></thead><tbody>
<tr><td align="right"><code>71</code></td><td align="right"><code>20</code></td><td align="right"><code>3</code></td><td align="right"><code>11</code></td></tr>
<tr><td align="right"><code>71</code></td><td align="right"><code>-20</code></td><td align="right"><code>-3</code></td><td align="right"><code>11</code></td></tr>
<tr><td align="right"><code>-71</code></td><td align="right"><code>20</code></td><td align="right"><code>-3</code></td><td align="right"><code>-11</code></td></tr>
<tr><td align="right"><code>-71</code></td><td align="right"><code>-20</code></td><td align="right"><code>3</code></td><td align="right"><code>-11</code></td></tr>
</tbody></table>
<span id="division-algorithm-exercise" />
<blockquote>
<p><strong>exercise</strong>:
Write a <code>div_rem</code> function that takes a dividend <code>a</code> and a nonzero divisor
<code>b</code> as inputs, and outputs a quotient <code>q</code> and a remainder <code>r</code> satisifying
the division algorithm.</p>
</blockquote>
<p>The division algorithm itself gives the specifications to validate that
<code>div_rem</code> is implemented correctly.  Following is a test in ruby that asserts
the properties from the division algorithm for some test inputs.  Note that I
am specifically suppressing test inputs where the arguments could be zero since
<code>div_rem(a, b)</code> is undefined when <code>b == 0</code>.</p>
<pre><code class="language-ruby">  def test_div_rem
    test_inputs(:include_zero =&gt; false).each do |(a, b)|
      quo, rem = div_rem(a, b)

      assert 0 &lt;= rem
      assert rem &lt; b.abs
      assert_equal a, b*quo + rem
    end
  end
</code></pre>
<p>Click the expand button to see an implementation of <code>div_rem</code> in ruby.</p>
<p><button class="fa fa-expand" onClick="showContent('div_rem')"></button></p>
<div id="div_rem" style="display: none;">
<pre><code class="language-ruby">def div_rem(a, b)
  rem = a % b
  rem += b.abs if rem &lt; 0
  quo = (a - rem) / b

  [quo, rem]
end
</code></pre>
</div>
<h2><a class="header" href="#divisibility-and-remainders" id="divisibility-and-remainders">divisibility and remainders</a></h2>
<p>The division algorithm is an extension of the idea of divisibility, as this
proposition makes clear.</p>
<blockquote>
<p><strong>proposition 3.</strong>
A nonzero integer \( b \) divides an integer \( a \) if and only if the
division of \( a \) by \( b \) yields a remainder of \( 0 \).</p>
</blockquote>
<blockquote>
<p><em>proof:</em>
If the division algorithm gives \( a = bq + r \) with \( r = 0\), then
\( a = bq \), which implies the \( b \mid a \).</p>
<p>Conversely, if \( b \mid a \), then \( a = bn \) for some \( n \).
Since the division algorithm produces a unique quotient and remainder, it
must be true that \( q = n \) and \( r = 0 \).</p>
</blockquote>
<span id="exercises" />
<h2><a class="header" href="#exercises-1" id="exercises-1">exercises</a></h2>
<p>Compute by hand the quotient and remainder when dividing:</p>
<ol>
<li>
<p>\( 345 \) by \( 14 \)</p>
</li>
<li>
<p>\( -872 \) by \( 77 \)</p>
</li>
<li>
<p>\( 7373 \) by \( -205 \)</p>
</li>
<li>
<p>\( -762 \) by \( -11 \)</p>
</li>
</ol>
<p><button onClick="showContent('solutions')">show solutions</button></p>
<div id="solutions" style="display: none;">
<ol>
<li>
<p>\( 345 = 14(24) + 9 \)</p>
</li>
<li>
<p>\( -872 = 77(-12) + 52 \)</p>
</li>
<li>
<p>\( 7373 = -205(-35) + 198 \)</p>
</li>
<li>
<p>\( -762 = -11(70) + 8 \)</p>
</li>
</ol>
</div>
<h1><a class="header" href="#greatest-common-divisor" id="greatest-common-divisor">greatest common divisor</a></h1>
<blockquote>
<p>A <strong>common divisor</strong> of two integers is an integer that divdes both integer.
The <strong>greatest common divisor</strong> of two integers is their largest positive
common divisor.</p>
</blockquote>
<ul>
<li>
<p>The notation for the greatest common divisor of \( a \) and \( b \) is
\( \gcd(a, b) \).</p>
</li>
<li>
<p>By definition, the greatest common divisor of two integers is independent of
the sign of the two integers --- the gcd is the same if you replace
\( a \) with \( -a \) or \( b \) with \( -b \).</p>
</li>
<li>
<p>The definition of gcd does not make sense if \( a \) and \( b \) are both
equal to \( 0 \).  The assumption for the rest of the section is that at
least one of them is nonzero.</p>
</li>
</ul>
<p>The existence of a greatest common divisor stems from the following fact: every
pair of integers has 1 as a positive common divisor, and can only have finitely
many positive common divisors since any positive divisor of an integer is less
than or equal to its absolute value.</p>
<h2><a class="header" href="#naive-computation" id="naive-computation">naive computation</a></h2>
<p>The greatest common divisor can be computed naively by finding the positive
divisors of each number and taking the intersection of the two sets.  For
example, to compute \( \gcd(322, 70) \)</p>
<ul>
<li>
<p>the positive divisors of \( 322 \) are
\( \{ 1, 2, 7, 14, 23, 46, 161, 322 \} \)</p>
</li>
<li>
<p>the positive divisors of \( 70 \) are
\( \{ 1, 2, 5, 7, 10, 14, 35, 70 \} \)</p>
</li>
<li>
<p>the positive common divisors of \( 322 \) and \( 70 \) are
\( \{ 1, 2, 7, 14 \} \)</p>
</li>
<li>
<p>therefore, the greatest common divisor is \( \gcd(322, 70) = 14 \)</p>
</li>
</ul>
<span id="naive-gcd-exercise" />
<blockquote>
<p><strong>exercise.</strong>
Write a <code>naive_gcd</code> function that returns the greatest common divisor of two
integer inputs.  It should only rely on divisibility checks.</p>
</blockquote>
<p><button class="fa fa-expand" onClick="showContent('naive_gcd')"></button></p>
<div id="naive_gcd" style="display: none;">
<pre><code class="language-ruby">def naive_gcd(a, b)
  divisor = 1
  upper_bound = [a.abs, b.abs].min
  (2..upper_bound).each do |i|
    if a % i == 0 &amp;&amp; b % i == 0
      divisor = i
    end
  end

  divisor
end
</code></pre>
</div>
<h2><a class="header" href="#euclidean-algorithm" id="euclidean-algorithm">Euclidean algorithm</a></h2>
<p>This naive gcd algorithm is slow, growing linearly in the size of the smaller
of the two integers.  The next proposition is instrumental in developing a more
efficient algorithm to compute the gcd.</p>
<span id="division-algorithm-and-gcd" />
<blockquote>
<p><strong>proposition 4.</strong>
If \( a = bq + r \), then \( \gcd(a, b) = \gcd(b, r) \).</p>
</blockquote>
<blockquote>
<p><em>proof:</em>
Since \( a = bq + r \) is a linear combination of \( b \) and \( r \),
any common divisor of \( b \) and \( r \) must also be a divisor of
\( a \).</p>
<p>Additionally, since \( r = a - bq \) is a linear combination of \( a \)
and \( b \), any common divisor of \( a \) and \( b \) must also be a
divisor of \( r \).</p>
<p>Taken together, the set of common divisors of \( a, b \) must be equal
to the set of common divisors of \( b, r \).  Therefore, \( \gcd(a, b) \)
must be equal to \( \gcd(b, r) \).</p>
</blockquote>
<p>This proposition combined with the division algorithm gives an efficient method
for computing the greatest common divisor.  Each time we use the division
algorithm, this proposition will give a smaller pair of numbers for computing
the greatest common divisor, since the division algorithm guarantees that the
remainder is smaller than the divisor in absolute value.</p>
<p>The <strong>Euclidean algorithm</strong> is repeated application of the division algorithm;
at each stage, we replace \( a, b \) with \( b, r \) until we reach a
remainder of \( 0 \).  At that point the gcd is trivial to compute.</p>
<p>As an example, we will calculate \( \gcd(322, 70) \) again, this time using the
Euclidean algorithm.  The left side of the table has each of the division
algorithm steps.  The right side has the greatest common divisor simplification
resulting from the division algorithm.</p>
<table><thead><tr><th align="right">division w/ remainder</th><th align="left">simplifed gcd</th></tr></thead><tbody>
<tr><td align="right"></td><td align="left">\( \gcd(322, 70) \)</td></tr>
<tr><td align="right">\( 322 = 70(4) + 42 \)</td><td align="left">\( = \gcd(70, 42) \)</td></tr>
<tr><td align="right">\( 70 = 42(1) + 28 \)</td><td align="left">\( = \gcd(42, 28) \)</td></tr>
<tr><td align="right">\( 42 = 28(1) + 14 \)</td><td align="left">\( = \gcd(28, 14) \)</td></tr>
<tr><td align="right">\( 28 = 14(2) +  0 \)</td><td align="left">\( = \gcd(14, 0) \)</td></tr>
<tr><td align="right"></td><td align="left">\( = 14 \)</td></tr>
</tbody></table>
<p>In the Euclidean algorithm, the last nonzero remainder is the gcd of the
original two integers.  Of extreme importance is the fact that the gcd is
computed without explicitly finding <strong>any</strong> of the divisors.</p>
<span id="euclidean-algorithm-exercise" />
<blockquote>
<p><strong>exercise.</strong>
Write a <code>euclidean_algorithm</code> function that prints the division algorithm
result from each step.</p>
</blockquote>
<p>Running the following code should produce the output below.</p>
<pre><code class="language-ruby">  euclidean_algorithm(239847, 95832)
</code></pre>
<pre><code>239847 == 95832 * 2 + 48183
95832 == 48183 * 1 + 47649
48183 == 47649 * 1 + 534
47649 == 534 * 89 + 123
534 == 123 * 4 + 42
123 == 42 * 2 + 39
42 == 39 * 1 + 3
39 == 3 * 13 + 0
</code></pre>
<p><button class="fa fa-expand" onClick="showContent('euclidean_algorithm')"></button></p>
<div id="euclidean_algorithm" style="display: none;">
<pre><code class="language-ruby">def euclidean_algorithm(a, b)
  while b != 0
    quo, rem = div_rem(a, b)
    puts &quot;#{a} == #{b} * #{quo} + #{rem}&quot;
    a, b = b, rem
  end
end
</code></pre>
</div>
<h2><a class="header" href="#computation-of-gcd" id="computation-of-gcd">computation of gcd</a></h2>
<p>As mentioned, the Euclidean algorithm gives an algorithm to compute the
greatest common divisor.  One formulation of this algorithm is the following:</p>
<span id="euclidean-algorithm" />
<blockquote>
<p>To compute \( \gcd(a, b) \)</p>
<ol>
<li>
<p>If \( b = 0, \) return \( \vert a \vert \).</p>
</li>
<li>
<p>If \( b \ne 0 \), compute \( a = bq + r \) and return to step 1,
replacing the pair \( (a, b) \) with \( (b, r) \).</p>
</li>
</ol>
</blockquote>
<p>This gcd algorithm terminates after finitely many steps: since the
remainders form a decreasing sequence of positive integers, there
can only be finitely many of them.</p>
<p>As mentioned before, in some programming languages, the modulus operator may
return a negative remainder when dealing with negative values.  However, the
result of <code>a % b</code> is still smaller than \( b \) in absolute value, so
repeated applications of the modulus operator will also terminate after
finitely many steps.  Since the proposition above applies regardless of whether
\( a = bq + r \) comes from the division algorithm, the greatest common
divisor algorithm may be implemented using <strong>only</strong> the modulus operator.</p>
<p>For example, here is the same table as above, but instead of performing the
whole division algorithm at each stage, we use only the modulus operator.</p>
<table><thead><tr><th align="right">modulus operator</th><th align="left">simplified gcd</th></tr></thead><tbody>
<tr><td align="right"></td><td align="left">\( \gcd(322, 70) \)</td></tr>
<tr><td align="right"><code>322 % 70 ~&gt; 42</code></td><td align="left">\( = \gcd(70, 42) \)</td></tr>
<tr><td align="right"><code>70 % 42 ~&gt; 28</code></td><td align="left">\( = \gcd(42, 28) \)</td></tr>
<tr><td align="right"><code>42 % 28 ~&gt; 14</code></td><td align="left">\( = \gcd(28, 14) \)</td></tr>
<tr><td align="right"><code>28 % 14 ~&gt; 0</code></td><td align="left">\( = \gcd(14, 0) \)</td></tr>
<tr><td align="right"></td><td align="left">\( = 14 \)</td></tr>
</tbody></table>
<p>Here is the same algorithm, rephrased.</p>
<blockquote>
<p>To compute <code>gcd(a, b)</code></p>
<ol>
<li>
<p>If <code>b == 0</code>  return <code>abs(a)</code>.</p>
</li>
<li>
<p>If <code>b != 0</code>, replace <code>(a, b)</code> with <code>(b, a % b)</code> and return to step 1.</p>
</li>
</ol>
</blockquote>
<span id="gcd-exercise" />
<h2><a class="header" href="#in-code-1" id="in-code-1">in code</a></h2>
<blockquote>
<p><strong>exercise.</strong>
Write a <code>gcd</code> function that uses the modulus operator: it should take two
integer inputs and produce their greatest common divisor.  Remember that
\( \gcd(0, 0) \) is undefined.</p>
</blockquote>
<p>For testing, we will verify some of the essential properties of the greatest
common divisor as well as some specific examples.  The last property in the
test is proved in <a href="sections/greatest_common_divisor.html#gcd-property">proposition 5</a> below.  In my ruby
implementation, <code>nil</code> is returned when the inputs are both zero.  You may opt
to do some error handling instead a null return value.</p>
<pre><code class="language-ruby">  def test_gcd
    test_inputs.each do |(a, b)|
      d = gcd(a, b)
      assert d &gt; 0
      assert a % d == 0
      assert b % d == 0
      assert_equal 1, gcd(a/d, b/d)
    end
  end

  def test_gcd_explicit
    assert_nil gcd(0, 0)

    [[10, 0], [-10, 0]].each do |(a, b)|
      assert_equal 10, gcd(a, b)
      assert_equal 10, gcd(b, a)
    end

    [[6, 3], [-6, 3], [6, -3], [-6, -3]].each do |(a, b)|
      assert_equal 3, gcd(a, b)
      assert_equal 3, gcd(b, a)
    end

    [[322, 70], [-322, 70], [322, -70], [-322, -70]].each do |(a, b)|
      assert_equal 14, gcd(a, b)
      assert_equal 14, gcd(b, a)
    end
  end
</code></pre>
<p><button class="fa fa-expand" onClick="showContent('gcd')"></button></p>
<div id="gcd" style="display: none;">
<pre><code class="language-ruby">def gcd(a, b)
  return if a == 0 &amp;&amp; b == 0

  while b != 0
    a, b = b, a % b
  end

  a.abs
end
</code></pre>
</div>
<p>This new algorithm to find the greatest common divisor is extremely fast.  It
can be proved that it grows logarithmically in the size of the smaller of the
two inputs, which is a vast improvement over the linear growth of the naive gcd
function we wrote.</p>
<h2><a class="header" href="#a-property-of-the-gcd" id="a-property-of-the-gcd">a property of the gcd</a></h2>
<span id="gcd-property" />
<blockquote>
<p><strong>proposition 5.</strong>
If \( d = \gcd(a, b) \), then \( \gcd({a \over d}, {b \over d} ) = 1. \)</p>
</blockquote>
<blockquote>
<p><em>proof:</em>
Let \( k = \gcd({a \over d}, {b \over d}) \).  Then
\( {a \over d} = km \) and \( {b \over d} = kn \).  This implies that
\( a = kdm \) and \( b = kdn \), so \( kd \) is a common divisor of
\( a \) and \( b \).  If \( k \) were larger than \( 1 \), then
\( kd \) would be a larger common divisor than the greatest common divisor
\( d \), a contradiction.</p>
</blockquote>
<span id="exercises" />
<h2><a class="header" href="#exercises-2" id="exercises-2">exercises</a></h2>
<ol>
<li>
<p>Explain why \( \gcd(0, 0) \) is undefined.</p>
</li>
<li>
<p>If \( a \) is nonzero, prove that \( \gcd(a, 0) = \vert a \vert \).</p>
</li>
<li>
<p>If \( b \mid a \), prove that \( \gcd(a, b) = \vert b \vert \).</p>
</li>
<li>
<p>Prove that every common divisor of two integers divides their greatest
common divisor.  (Hint: look over the proof of
<a href="sections/greatest_common_divisor.html#division-algorithm-and-gcd">proposition 4</a>.)</p>
</li>
<li>
<p>Benchmark <code>gcd</code> vs <code>naive_gcd</code> to convince yourself of the stated time
complexity.</p>
</li>
</ol>
<p><button onClick="showContent('solutions')">show solutions</button></p>
<div id="solutions" style="display: none;">
<ol>
<li>
<p>Since every integer divides \( 0 \), then every integer is a common
divisor of \( 0 \) and \( 0 \), so there is no <em>greatest</em> common
divisor.</p>
</li>
<li>
<p>Again, since every integer divides \( 0 \), the set of common divisors of
\( 0 \) and an integer \( a \) is equal to the set of divisors of
\( a \).  The largest divisor of \( a \) is its absolute value, so that
must be the gcd.</p>
</li>
<li>
<p>The greatest common divisor is less than or equal to the absolute value of
the smaller of the two integers.  If \( b \) divides \( a \), then
\( b \) must be smaller in absolute value.  Therefore, the gcd is at most
\( \vert b \vert \).  In addition, since \( b \) divides \( a \), we
know that \( \vert b \vert \) divides \( a \), which proves that
\( \gcd(a, b) = \vert b \vert \).</p>
</li>
<li>
<p>In the course of proving <a href="sections/greatest_common_divisor.html#division-algorithm-and-gcd">proposition 4</a>, we
noted that the set of common divisors of \( a, b \) is equal to the set of
common divisors of \( b, r \) if \( a = qb + r \).  Repeating the
division algorithm as we do in the Euclidean algorithm, we eventually find
that the common divisors of two integers is equal to the set of divisors of
their gcd and zero.  This proves that each common divisor divides the
greatest common divisor.</p>
</li>
</ol>
</div>
<h1><a class="header" href="#bezouts-identity" id="bezouts-identity">bezout's identity</a></h1>
<blockquote>
<p><strong>proposition 6 (Bezout's identity).</strong>
The greatest common divisor can always be expressed as a linear combination
of the two integers.  In other words, given two integers \( a \) and
\( b \), there exist integers \( x \) and \( y \) such that
\( ax + by = \gcd(a, b) \).</p>
</blockquote>
<p>The proof of this is constructive and most easily understood through a few
examples.</p>
<h2><a class="header" href="#example-1" id="example-1">example 1</a></h2>
<p>For example, if \( a = 322 \) and \( b = 70 \), Bezout's identity implies
that \( 322x + 70y = 14 \) for some integers \( x \) and \( y \).  Such
integers might be found by brute force.  In this case, a brute force search
might arrive at the solution \( (x, y) = (-2, 9) \).  However, the Euclidean
algorithm provides an efficient way to find a solution.</p>
<p>The first division yields \( 322 = 70(4) + 42 \) with a quotient of
\( q_0 = 4 \) and a remainder of \( r_0 = 42 \).  Solving for \( r_0 \)
gives \( 42 = 322 - 70(4) \).  In particular, we have shown that the
remainder \( r_0 \) can be expressed as a linear combination of \( 322 \)
and \( 70 \), namely \( r_0 = 322(1) + 70(-4) \).</p>
<p>The second division yields \( 70 = 42(1) + 28 \) with a quotient of
\( q_1 = 1 \) and a remainder of \( r_1 = 28 \).  Solving for
\( r_1 \) gives \( 28 = 70 - 42(1) \).  The linear combination for
\( r_0 = 42 \) may be substituted here and simplified to
\( 28 = -322 + 70(5) \). Therefore, the remainder
\( r_1 = 322(-1) + 70(5) \) is also a linear combination of the original two
integers.</p>
<p>The third division gives \( 42 = 28(1) + 14 \) with a quotient of
\( q_2 = 1 \) and a remainder of \( r_2 = 28 \).  The linear combinations
for \( r_0 = 42 \) and \( r_1 = 28 \) may be substituted into this
expression.  Then solving for the new remainder, it will simplify to
\( 14 = 322(2) + 70(-9) \), which is the solution to Bezout's identity
that was listed above.</p>
<p>These computations are summarized in the table below. In each of the first
three rows, the last column is how to express each remainder \( r \) as a
linear combination of the original \( a = 322 \) and \( b = 70 \), namely,
\( r = 322x + 70y \).  The last row verifies that the algorithm has
terminated, ie, that the gcd of \( 322 \) and \( 70 \) is the
second-to-last remainder \( 14 \).</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right">\( 322 \)</td><td align="right">\( 70 \)</td><td align="right">\( 42 \)</td><td align="right">\( 4 \)</td><td align="left">\( (1, -4) \)</td></tr>
<tr><td align="right">\( 70 \)</td><td align="right">\( 42 \)</td><td align="right">\( 28 \)</td><td align="right">\( 1 \)</td><td align="left">\( (-1, 5) \)</td></tr>
<tr><td align="right">\( 42 \)</td><td align="right">\( 28 \)</td><td align="right">\( 14 \)</td><td align="right">\( 1 \)</td><td align="left">\( (2, -9) \)</td></tr>
<tr><td align="right">\( 28 \)</td><td align="right">\( 14 \)</td><td align="right">\( 0 \)</td><td align="right">\( 2 \)</td><td align="left"></td></tr>
</tbody></table>
<p>We would like a programatic way to compute the \( (x, y) \) pairs as we go.
Suppose that on some row we have \( a' = b'q + r \) and that we have already
calculated that \( a' = 322 x_0 + 70 y_0 \) and
\( b' = 322 x_1 + 70 y_1 \).  We can substitute these expressions into the
division algorithm equation to get
\[ 322 x_0 + 70 y_0 = (322 x_1 + 70 y_1)q + r. \]
Solving for \( r \) and rearranging, we get
\[ r = 322 (x_0 - x_1 q) + 70(y_0 - y_1 q). \]</p>
<p>This is great news, because we can compute the the next \( (x, y) \)
pair from the previous two pairs.  The recursive relation for both \( x \)
and \( y \) can be expressed as
\[ u_2 = u_0 - u_1 \cdot q. \]
In other words, the <code>next_value = previous_value - current_value * quotient</code>.</p>
<p>To see this in action, we observe first that \( a = a(1) + b(0) \) and
\( b = a(0) + b(1) \), so the initial values for the \( (x, y) \) pairs
are \( (1, 0) \) and \( (0, 1) \).</p>
<p>The first quotient is \( q = 4 \), so the first \( (x, y) \) pair is
\[ (1, 0) - (0, 1) \cdot 4 = (1 - 0, 0 - 4) = (1, -4). \]
(Note that we used vector addition and scalar multiplication to express this
succinctly.)  The second quotient is \( q = 1 \), so the second pair is
\[ (0, 1) - (1, -4) \cdot 1 = (0 - 1, 1 + 4) = (-1, 5). \]
The third quotient is \( q = 1 \), so the third pair is
\[ (1, -4) - (-1, 5) \cdot 1 = (1 + 1, -4 - 5) = (2, -9). \]
Since the following remainder is \( 0 \), the algorithm terminates.</p>
<h2><a class="header" href="#example-2" id="example-2">example 2</a></h2>
<p>Here is another example to illustrate this process.  Suppose we want to
find a solution to \( 5831 x + 482 y = \gcd(5831, 482) \).  We seed our table
with the initial \( (x, y) \) pairs and with \( a \) and \( b \) as the
first &quot;remainders&quot;.</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 5831 \)</td><td align="right"></td><td align="left">\( (1, 0) \)</td></tr>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 482 \)</td><td align="right"></td><td align="left">\( (0, 1) \)</td></tr>
</tbody></table>
<p>The division of \( 5381 \) by \( 482 \) yields \( 5831 = 482(12) + 47 \).
Since the quotient is \( q = 12 \), we calculate the next \( (x, y) \) pair
to be
\[ (1, 0) - (0, 1) \cdot 12 = (1 - 0, 0 - 12) = (1, -12) \]
and we fill in the new row on the table.</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 5831 \)</td><td align="right"></td><td align="left">\( (1, 0) \)</td></tr>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 482 \)</td><td align="right"></td><td align="left">\( (0, 1) \)</td></tr>
<tr><td align="right">\( 5831 \)</td><td align="right">\( 482 \)</td><td align="right">\(47 \)</td><td align="right">\( 12 \)</td><td align="left">\( (1, -12) \)</td></tr>
</tbody></table>
<p>The division of \( 482 \) by \( 47 \) yields \( 482 = 47(10) + 12 \).
Since the quotient is \( q = 10 \), we calculate the next \( (x, y) \) pair
to be
\[ (0, 1) - (1, -12) \cdot 10 = (0 - 10, 1 + 120) = (-10, 121) \]
and we fill in the new row on the table.</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 5831 \)</td><td align="right"></td><td align="left">\( (1, 0) \)</td></tr>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 482 \)</td><td align="right"></td><td align="left">\( (0, 1) \)</td></tr>
<tr><td align="right">\( 5831 \)</td><td align="right">\( 482 \)</td><td align="right">\(47 \)</td><td align="right">\( 12 \)</td><td align="left">\( (1, -12) \)</td></tr>
<tr><td align="right">\( 482 \)</td><td align="right">\( 47 \)</td><td align="right">\(12 \)</td><td align="right">\( 10 \)</td><td align="left">\( (-10, 121) \)</td></tr>
</tbody></table>
<p>The division of \( 47 \) by \( 12 \) yields \( 47 = 12(3) + 11 \).  With
a quotient of \( q = 3 \), the next \( (x, y) \) pair is
\[ (1, -12) - (-10, 121) \cdot 3 = (1 + 30, -12 - 363) = (31, -375) \]
and we fill in the new row on the table.</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 5831 \)</td><td align="right"></td><td align="left">\( (1, 0) \)</td></tr>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 482 \)</td><td align="right"></td><td align="left">\( (0, 1) \)</td></tr>
<tr><td align="right">\( 5831 \)</td><td align="right">\( 482 \)</td><td align="right">\(47 \)</td><td align="right">\( 12 \)</td><td align="left">\( (1, -12) \)</td></tr>
<tr><td align="right">\( 482 \)</td><td align="right">\( 47 \)</td><td align="right">\(12 \)</td><td align="right">\( 10 \)</td><td align="left">\( (-10, 121) \)</td></tr>
<tr><td align="right">\( 47 \)</td><td align="right">\( 12 \)</td><td align="right">\(11 \)</td><td align="right">\( 3 \)</td><td align="left">\( (31, -375) \)</td></tr>
</tbody></table>
<p>The division of \( 12 \) by \( 11 \) yields \( 12 = 11(1) + 1 \).  With a
quotient of \( q = 1 \), the next pair is
\[ (-10, 121) - (31, -375) \cdot 1 = (-10 - 31, 121 + 375) = (-41, 496) \]
and we fill in the new row.</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 5831 \)</td><td align="right"></td><td align="left">\( (1, 0) \)</td></tr>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 482 \)</td><td align="right"></td><td align="left">\( (0, 1) \)</td></tr>
<tr><td align="right">\( 5831 \)</td><td align="right">\( 482 \)</td><td align="right">\(47 \)</td><td align="right">\( 12 \)</td><td align="left">\( (1, -12) \)</td></tr>
<tr><td align="right">\( 482 \)</td><td align="right">\( 47 \)</td><td align="right">\(12 \)</td><td align="right">\( 10 \)</td><td align="left">\( (-10, 121) \)</td></tr>
<tr><td align="right">\( 47 \)</td><td align="right">\( 12 \)</td><td align="right">\(11 \)</td><td align="right">\( 3 \)</td><td align="left">\( (31, -375) \)</td></tr>
<tr><td align="right">\( 12 \)</td><td align="right">\( 11 \)</td><td align="right">\(1 \)</td><td align="right">\( 1 \)</td><td align="left">\( (-41, 496) \)</td></tr>
</tbody></table>
<p>The final division of \( 11 \) by \( 1 \) yields \( 11 = 1(11) + 0 \).
With a remainder of \( 0 \), the algorithm has terminated.  The greatest
common divisor is \( \gcd(5831, 482) = 1 \) and \( (-41, 496) \) is a
solution to \( 5831 x + 482 y = 1 \).</p>
<h2><a class="header" href="#in-code-2" id="in-code-2">in code</a></h2>
<p>The examples above can be generalized into a constructive proof of Bezout's
identity -- the proof is an algorithm to produce a solution.</p>
<span id="bezout-algorithm" />
<blockquote>
<p><strong>Bezout algorithm for positive integers.</strong>
Given <em>positive</em> integers <code>a</code> and <code>b</code>, we want to find integers <code>x</code> and <code>y</code>
such that <code>a * x + b * y == gcd(a, b)</code>.  Initially set <code>prev = [1, 0]</code> and
<code>curr = [0, 1]</code>.</p>
<ol>
<li>If <code>b == 0</code>, return <code>prev</code>.</li>
<li>Calculate <code>q, r = div_rem(a, b)</code>.</li>
<li>Calculate <code>x = prev[0] - curr[0] * q</code> and <code>y = prev[1] - curr[1] * q</code>.</li>
<li>Replace <code>a, b</code> with <code>b, r</code>.</li>
<li>Replace <code>prev, curr</code> with <code>curr, [x, y]</code>.</li>
<li>Return to Step 1.</li>
</ol>
</blockquote>
<p>The algorithm needs to be adjusted slightly for zero or negative values.  Run
the algorithm described for various combinations of positive, negative, and
zero values, checking whether each resulting pair <code>x, y</code> actually satisfies
<code>a * x + b * y == gcd(a, b)</code>.</p>
<p>While exploring zero/negative values, there are 3 cases to consider:</p>
<ol>
<li>when the algorithm returns immediately, ie, when the original <code>b</code> is zero.</li>
<li>when the algorithm returns after one iteration, ie, when the first remainder
<code>r</code> is zero.</li>
<li>when the algorithm returns after two or more iterations.</li>
</ol>
<p>We seeded the algorithm initially with <code>prev = [1, 0]</code> and <code>curr = [0, 1]</code>.
We did this in order to express <code>a</code> and <code>b</code> in terms of themselves, ie,
<code>a == 1 * a + 0 * b</code> and <code>b == 0 * a + 1 * b</code>.  With two or more iterations,
the division algorithm guarantees that the remainder is positive, so the
calculated pair at that point gives a positive number <code>a * x + b * y</code>.
However, if the algorithm terminates during the first or second iteration, we
would return either <code>[1, 0]</code> or <code>[0, 1]</code>, in which case we may end up with
<code>a * x + b * y</code> as a negative value, which would be incorrect since the
greatest common divisor is always positive.</p>
<p>To account for this, we may need to negate the values of <code>prev</code> in Step 1
before returning.  Consider these two examples.</p>
<ol>
<li>
<p>Let <code>a = -10</code> and <code>b = 0</code>.  Since <code>b == 0</code>, we return the original
<code>prev = [1, 0]</code> immediately.  Notice that <code>1 * -10 + 0 * 0 == -10</code> while
<code>gcd(-10, 0) == 10</code>.  In this case, we need to return the original <code>prev</code>
but with negated values, ie, <code>[-1, 0]</code>.</p>
</li>
<li>
<p>Let <code>a = 10</code> and <code>b = -5</code>.  Since <code>b != 0</code>, we calculate <code>q = -2</code> and
<code>r = 0</code>.  When we return to Step 1, we have <code>new_b = r == 0</code>, so we return
<code>new_prev = curr == [0, 1]</code>.  Notice that <code>0 * 10 + 1 * -5 = -5</code> while
<code>gcd(10, -5) == 5</code>.  In this case, we need to return the <code>new_prev</code> but with
negated values, ie, <code>[0, -1]</code>.</p>
</li>
</ol>
<p>The conclusion is that Step 1 requires the following adjustment:</p>
<blockquote>
<ol>
<li>If <code>b == 0</code>, return <code>prev</code> if <code>a &gt; 0</code>, otherwise return <code>prev</code> with
negated values.</li>
</ol>
</blockquote>
<span id="bezout-exercise" />
<blockquote>
<p><strong>exercise.</strong>
Write a <code>bezout</code> function that takes integer inputs <code>(a, b)</code> and
produces integers <code>(x, y)</code> such that <code>a * x + b * y = gcd(a, b)</code>.</p>
</blockquote>
<p>Testing this function is very simple: regardless of the inputs, Bezout's
identity must be satisfied.  Make sure you include test inputs for the special
cases discussed above.</p>
<pre><code class="language-ruby">  def test_bezout
    test_inputs.each do |(a, b)|
      x, y = bezout(a, b)
      assert_equal gcd(a, b), a * x + b * y
    end
  end

  def test_bezout_explicit
    assert_nil bezout(0, 0)
  end
</code></pre>
<p><button class="fa fa-expand" onClick="showContent('bezout')"></button></p>
<div id="bezout" style="display: none;">
<pre><code class="language-ruby">def bezout(a, b)
  return if a == 0 &amp;&amp; b == 0

  prev, curr = [[1, 0], [0, 1]]

  while b != 0
    quo, rem = div_rem(a, b)
    nxt = [0, 1].map { |i| prev[i] - curr[i] * quo }

    a, b = b, rem
    prev, curr = curr, nxt
  end

  a &lt; 0 ? prev.map { |u| -u } : prev
end
</code></pre>
</div>
<h2><a class="header" href="#applications-of-bezouts-identity" id="applications-of-bezouts-identity">applications of bezout's identity</a></h2>
<p>Bezout's identity is a powerful tool since it gives a relationship between
integers to their greatest common divisor.  Some proofs can be vastly
simplified by leveraging this new capability.  Here are a few propositions
that can be proved using Bezout's identity.</p>
<blockquote>
<p><strong>proposition 9.</strong>
The greatest common divisor of two integers is divisible by any common
divisor.</p>
</blockquote>
<blockquote>
<p><em>proof</em>:
Let \( k \) be a common divisor of \( a, b \) and let \( d \) be their
greatest common divisor.  Bezout's lemma allows us to write \( ax + by = d \)
for some integers \( x, y \).  Since \( k \) divides both \( a \) and
\( b \), it divides the linear combination \( ax + by \), which is equal
to \( d \).</p>
</blockquote>
<span id="divides-product-but-prime-to-first" />
<blockquote>
<p><strong>proposition 10.</strong>
If an integer \( c \) divides a product \( ab \) and
\( \gcd(a, c) = 1 \), then \( c \) divides \( b \).</p>
</blockquote>
<blockquote>
<p><em>proof:</em>
Since \( \gcd(a, c) = 1 \), then we can write \( ax + cy = 1 \) for some
integers \( x, y \).  Multiplying both sides by \( b \), we get
\[ abx + bcy = b. \]
The first term is divisible by \( c \), since \( c \) is assumed to
divide the product \( ab \).  The second term is divisible by \( c \)
since \( c \) occurs in that term.  Therefore, their sum is divisible by
\( c \), which proves that \( b \) is divisible by
\( c \).</p>
</blockquote>
<h1><a class="header" href="#least-common-multiple" id="least-common-multiple">least common multiple</a></h1>
<span id="least-common-multiple" />
<blockquote>
<p>A <strong>common multiple</strong> of two integers is an integer divisible by both
integers.  The <strong>least common multiple</strong> of two integers is the smallest
positive common multiple.</p>
</blockquote>
<ul>
<li>
<p>The notation for the least common multiple of \( a \) and \( b \) is
\( \operatorname{lcm}(a, b) \).</p>
</li>
<li>
<p>By definition, the least common multiple of two integers is independent of
the sign of the two integers --- the \( \operatorname{lcm} \) is the same
if you replace \( a \) with \( -a \) or \( b \) with \( -b \).</p>
</li>
<li>
<p>The definition of \( \operatorname{lcm} \) does not make sense if either
\( a \) or \( b \) are is equal to \( 0 \).</p>
</li>
<li>
<p>For the remainder of the section, we will assume integers to be nonzero.</p>
</li>
</ul>
<p>The existence of a least common multiple stems from the fact that the absolute
value of the product \( |ab| \) is a positive common multiple of \( a \)
and \( b \).</p>
<h2><a class="header" href="#naive-computation-1" id="naive-computation-1">naive computation</a></h2>
<p>The least common multiple can be computed naively by checking every
multiple of one of them up to their product to see if it is divisible
by the other.  For example, to compute \( \operatorname{lcm}(154, 56) \)</p>
<ul>
<li>
<p>start with \( 154 \) and keep adding \( 154 \) until it is divisible by
\( 56 \)</p>
</li>
<li>
<p>\( 56 \) does not divide \( 154 \), \( 154(2) \), or \(154(3) \)</p>
</li>
<li>
<p>however, \( 154(4) = 616 = 56(11) \) is divisible by \( 56 \)</p>
</li>
<li>
<p>the least common multiple is \( \operatorname{lcm}(154, 56) = 616 \)</p>
</li>
</ul>
<span id="naive-lcm-exercise" />
<blockquote>
<p><strong>exercise.</strong>
Write a <code>naive_lcm</code> function that returns the least common multiple of two
nonzero integer inputs.  It should only rely on divisibility checks.</p>
</blockquote>
<p><button class="fa fa-expand" onClick="showContent('naive_lcm')"></button></p>
<div id="naive_lcm" style="display: none;">
<pre><code class="language-ruby">def naive_lcm(a, b)
  return if a == 0 || b == 0

  smaller, larger = [a, b].map(&amp;:abs).sort

  multiple = larger
  while multiple % smaller != 0
    multiple += larger
  end

  multiple
end
</code></pre>
</div>
<p>The time complexity of this algorithm, similar to the naive gcd algorithm,
grows linearly in the smaller of the two arguments.</p>
<h2><a class="header" href="#a-property-of-the-lcm" id="a-property-of-the-lcm">a property of the lcm</a></h2>
<span id="lcm-divides-common-multiples" />
<blockquote>
<p><strong>proposition 7.</strong>
Every common multiple of two integers is a multiple of their least common
multiple.</p>
</blockquote>
<blockquote>
<p><em>proof:</em>
Let \( k \) be a common multiple of \( a \) and \( b \) and let \( m \)
be their least common multiple.  Dividing \( k \) by \( m \) yields
\( k = mq + r \), where \( 0 \le r &lt; m \).  Since \( r = k - mq \) is a
linear combination of \( k \) and \( m \), then \( r \) must be
divisible by both \( a \) and \( b \), ie, \( r \) must be a common
multiple of \( a \) and \( b \).  If \( r \) were nonzero, then it
would be a smaller positive common multiple than the least common multiple, a
contradiction.  Therefore, \( r = 0 \) and \( m \mid k \).</p>
</blockquote>
<h2><a class="header" href="#relation-to-greatest-common-divisor" id="relation-to-greatest-common-divisor">relation to greatest common divisor</a></h2>
<p>In order to compute the least common multiple efficiently, we need to prove an
identity involving the greatest common divisor.</p>
<span id="least-common-multiple" />
<blockquote>
<p><strong>proposition 8.</strong>
If \( a \) and \( b \) are nonzero integers, then
\( \gcd(a, b) \cdot \operatorname{lcm}(a, b) = \vert ab \vert \).</p>
</blockquote>
<blockquote>
<p><em>proof:</em>
For simplicity, we may assume that \( a \) and \( b \) are positive,
since both the gcd and the lcm are independent of sign.  Define
\( d = \gcd(a, b) \) and \( m = \operatorname{lcm}(a, b) \). The goal
is to prove that \( md = ab \).</p>
<p>Since \( d \) is a common divisor of \( a, b\), the integer \( ab/d \)
can be expressed as \( (a/d) \cdot b \) or as \( a \cdot (b/d) \).  This
implies that \( ab/d \) must be a common multiple of \( a \) and
\( b \).  By <a href="sections/least_common_multiple.html#lcm-divides-common-multiples">proposition 7</a>,
\( ab/d \) must be a multiple of \( m \), hence
\[ ab/d = mk \quad\implies\quad ab = mdk \quad\implies\quad md \mid ab. \]</p>
<p>Next, using Bezout's identity, there exist integers \( x, y \) such that
\( d = ax + by \).  Multiplying both sides by \( m \) yields
\[ md = amx + bmy. \]
Since \( b \mid m \), it follows that \( ab \mid am \), so it divides the
first term.  Since \( a \mid m \), it follows that \( ab \mid bm \), so
it also divides the second term.  Therefore, \( ab \) divides the whole
expression, which implies that \( ab \mid md \).</p>
<p>Since each of \( md \) and \( ab \) is positive and divides the other,
they must be equal.</p>
</blockquote>
<h2><a class="header" href="#in-code-3" id="in-code-3">in code</a></h2>
<span id="lcm-exercise" />
<blockquote>
<p><strong>exercise.</strong>
Write an <code>lcm</code> function that returns the least common multiple of two
nonzero integer inputs.  It should use the <code>gcd</code> function and
<a href="sections/least_common_multiple.html#least-common-multiple">proposition 8</a>.</p>
</blockquote>
<p>For testing, we can compare the result to the <code>naive_lcm</code> result.  Be careful
to limit this type of test to just a few <em>positive</em> values since the naive
function is slow and restricted.  For more general test cases, we'll use the
proposition, even though we also rely on the proposition for the
implementation.</p>
<pre><code class="language-ruby">  def limited_test_inputs
    test_inputs(
      :include_zero =&gt; false,
      :include_negative =&gt; false,
      :include_reverse =&gt; false
    )
  end

  def test_lcm
    limited_test_inputs.each do |(a, b)|
      assert_equal naive_lcm(a, b), lcm(a, b)
    end

    test_inputs(:include_zero =&gt; false).each do |(a, b)|
      assert_equal (a * b).abs, gcd(a, b) * lcm(a, b)
    end
  end

  def test_lcm_explicit
    [[5, 0], [0, 5], [0, 0]].each do |(a, b)|
      assert_nil lcm(a, b)
    end
  end
</code></pre>
<p><button class="fa fa-expand" onClick="showContent('lcm')"></button></p>
<div id="lcm" style="display: none;">
<pre><code class="language-ruby">def lcm(a, b)
  return if a == 0 || b == 0

  ((a / gcd(a, b)) * b).abs
end
</code></pre>
</div>
<h1><a class="header" href="#linear-equations" id="linear-equations">linear equations</a></h1>
<p>In this section, we discuss finding integer solutions to integer linear
equations.  An integer linear equation in two variables \( x, y \) is of the
form
\[ ax + by = c \]
where \( a, b, c \) are given integers.  We are interested in finding, if possible,
integers \( x, y \) that satisfy the equation.</p>
<p>The linear equation \( ax + by = c \) defines a line in the plane.  As such,
there are infinitely many <em>real</em> solutions, for example
\( (x, y) = (\frac{c}{a}, 0) \).  It is not readily apparent under what
conditions there exist points on the line with integer coordinates.</p>
<h2><a class="header" href="#existence-of-a-solution" id="existence-of-a-solution">existence of a solution</a></h2>
<span id="linear-equation-solution-existence" />
<blockquote>
<p><strong>proposition 11.</strong>
Given integers \( a, b, c \), there exist integers \( x, y \) such that
\( ax + by = c \) if and only if \( c \) is divisible by
\( \gcd(a, b) \).</p>
</blockquote>
<blockquote>
<p><em>proof:</em>
Suppose that \( ax + by = c \) for some integers \( x, y \).  Since
\( c \) is a linear combination of \( a \) and \( b \), then
<a href="sections/divisibility.html#linear-combination">proposition 1</a> implies that
\( c \) is divisible by any common divisor of \( a, b \).  In particular,
\( c \) is divisible by their greatest common divisor.</p>
<p>On the other hand, suppose that \( c \) is divisible by
\( d = \gcd(a, b) \).  Then \( c = k d \) for some integer
\( k \).  By <a href="sections/bezouts_identity.html">Bezout's identity</a>, there exist
integers \( u, v \) such that \( au + bv = d \).  Multiplying
both sides by \( k \), we have
\[ a(ku) + b(kv) = k d = c, \]
hence \( (x, y) = (ku, kv) \) is an integer solution to
\( ax + by = c \).</p>
</blockquote>
<p>This is a constructive proof: if a solution exists, it gives a mechanism to
find a solution.</p>
<h3><a class="header" href="#example" id="example">example</a></h3>
<p>Suppose we want to solve \( 322 x + 70 y = 126 \).</p>
<ol>
<li>
<p>Compute <code>gcd(322, 70) ~&gt; 14</code>.</p>
</li>
<li>
<p>Compute <code>div_rem(126, 14) ~&gt; [9, 0]</code> and conclude that a solution exists
since \( 126 = 14 \cdot 9 \).</p>
</li>
<li>
<p>Compute <code>bezout(322, 70) ~&gt; [2, -9]</code> to get the equation
\( 322(2) + 70(-9) = 14 \).</p>
</li>
<li>
<p>Scale this equation by a factor of \( 9 \) to get
\( 322(18) + 70(-81) = 126 \).</p>
</li>
</ol>
<p>Therefore, one solution is \( (x, y) = (18, -81) \).</p>
<h2><a class="header" href="#parametrization-of-solutions" id="parametrization-of-solutions">parametrization of solutions</a></h2>
<span id="linear-equation-solutions-parametrization">
<blockquote>
<p><strong>proposition 12.</strong>
Given integers \( a, b, c \), if there exists an integer solution to the
linear equation \( ax + by = c \), then there exist infinitely many
solutions.  Moreover, the set of all solutions may be obtained from a single
solution \( (x_0, y_0) \) by taking all pairs of the form
\[ x = x_0 + \tfrac{b}{d} k, \quad y = y_0 - \tfrac{a}{d} k \]
where \( k \) is any integer and \( d = \gcd(a, b) \).</p>
</blockquote>
<p>Before giving a formal proof, let's talk about the intuition behind these
additional solutions.  As mentioned above, the equation \( ax + by = c \)
identifies a line in the plane.  Solving for \( y \), we get
\[ y = -\tfrac{a}{b}x + c, \]
so the slope of this line is the rational number \( \tfrac{-a}{b} \).  If
\( d = \gcd(a, b) \), then the reduced form of the slope is
\( \tfrac{ -a/d }{ b/d } \).  If there is an integer point
\( (x_0, y_0) \) on the line, then we can use this slope to find the &quot;next&quot;
integer point.  Since the slope is the change in \( y \) divided by the
change in \( x \), that means we can add \( \tfrac{b}{d} \) to the
\( x \)-value and subtract \( \tfrac{a}{d} \) from the \( y \)-value to
get the &quot;next&quot; integer point.  To get <em>all</em> integer points, we apply this same
process in both directions indefinitely.</p>
<h3><a class="header" href="#example-1" id="example-1">example</a></h3>
<p>Continuing the example from above of \( 322 x + 70 y = 126 \), the
corresponding line in slope-intercept form is
\[ y = -\tfrac{322}{70} x + \tfrac{126}{70} = -\tfrac{23}{5} x + \tfrac{9}{5}. \]
We already found a base solution of \( (18, -81) \).  So, according to this
proposition, every solution is of the form
\[ x = 18 + 5k, \quad y = -81 - 23k \]
where \( k \) can be any integer.  For instance, the solutions closest
to the origin occur when \( k = -3, -4 \), ie, at
\[ (3, -12) \quad \text{ and } \quad (-2, 11). \]</p>
<div class="chart-container" style="position: relative;">
  <canvas id="linear-graph"></canvas>
</div>
<script>
  const gridColor = "#444";
  const pointColor = "#aa5325";
  const label = "integer points";
  const labels = [-7, -2, 3, 8, 13, 18, 23];
  const data = labels.map(x => (-23 * x + 9) / 5);
  const yTicks = { beginAtZero: false, stepSize: 20, suggestedMin: -110, suggestedMax: 30 };
  const xTicks = { stepSize: 5 };
  const gridLines = { color: gridColor, zeroLineColor: gridColor };
  const datasetOptions = {
    borderColor: "#007999",
    pointBackgroundColor: pointColor,
    pointBorderColor: pointColor,
    fill: false
  };
  let ctx = document.getElementById("linear-graph");
  let linearGraph = new Chart(ctx, {
    type: 'line',
    data: {
      labels,
      datasets: [{ label, data, ...datasetOptions }],
    },
    options: {
      scales: {
        yAxes: [{ gridLines, ticks: yTicks }],
        xAxes: [{ gridLines, ticks: xTicks }],
      }
    },
  });
</script>
<blockquote>
<p><em>proof of proposition 12:</em>
Supposing we have two solutions to \( ax + by = c \), say \( (x_0, y_0) \)
and \( (x_1, y_1) \), then
\[ a x_1 + b y_1 = c = a x_0 + b y_0. \]
Moving the \( x \)'s and \( y \)'s to opposite sides, we get
\[ a (x_1 - x_0) = b (y_0 - y_1). \]
Both sides are divisible by \( d = \gcd(a, b) \), therefore
\[ \tfrac{a}{d} (x_1 - x_0) = \tfrac{b}{d} (y_0 - y_1) \]
is an integer equation.  This means that the integer \( \tfrac{b}{d} \)
must divide the product \( \tfrac{a}{d} (x_1 - x_0) \).  By
<a href="sections/greatest_common_divisor.html#gcd-property">proposition 5</a>,
we know that \( \gcd(\tfrac{a}{d}, \tfrac{b}{d}) = 1 \).  Therefore,
<a href="sections/bezouts_identity.html#divides-product-but-prime-to-first">proposition 10</a>
guarantees that the integer \( \tfrac{b}{d} \) must divide \( x_1 - x_0 \).  In
other words, there is an integer \( k \) such that
\[
x_1 - x_0 = \tfrac{b}{d} k
\quad \implies \quad
x_1 = x_0 + \tfrac{b}{d} k.
\]
Plugging the first version of this equation into the left-hand side above, we
get
\[ \tfrac{a}{d} \cdot \tfrac{b}{d} k = \tfrac{b}{d} (y_0 - y_1) \]
which simplifies to
\[
\tfrac{a}{d} k = y_0 - y_1
\quad \implies \quad
y_1 = y_0 - \tfrac{a}{d} k.
\]
This proves that any additional solution \( (x_1, y_1) \) is of the form
prescribed by the proposition.</p>
<p>To finish the proof, it remains to show that pairs of that form are always
solutions.  Let \( k \) be any integer and define
\( x_1 = x_0 + \tfrac{b}{d} k \) and \( y_1 =  y_0 - \tfrac{a}{d} k \).
Then,
\[
a x_1 + b y_1
= a(x_0 + \tfrac{b}{d} k) + b(y_0 - \tfrac{a}{d} k)
= a x_0 + b y_0.
\]
Therefore, if \( (x_0, y_0) \) is a solution, then so is \( (x_1, y_1) \).</p>
</blockquote>
<h2><a class="header" href="#in-code-4" id="in-code-4">in code</a></h2>
<span id="linear-equation-exercise" />
<blockquote>
<p><strong>exercise.</strong>
Write some code that takes integer inputs <code>(a, b, c)</code> and computes integer
solutions <code>(x, y)</code> to <code>a * x + b * y = gcd(a, b)</code>.</p>
</blockquote>
<p>I opted to write a <code>LinearEquationSolver</code> class in ruby.  Perhaps your solution
will have very different structure.  With the syntax I chose, the computations
from the examples could be accomplished as follows.</p>
<pre><code class="language-ruby">solver = LinearEquationSolver.new(322, 70, 126)

solver.base_solution
# ~&gt; [18, -81]

solver.solution(-3)
# ~&gt; [3, -12]

solver.solution(-4)
# ~&gt; [-2, 11]
</code></pre>
<p>I have two tests: one for when there are
solutions, and one for when there are no solutions.</p>
<pre><code class="language-ruby">  def test_solvable_equation
    a, b, c = 12, 15, 99
    solver = LinearEquationSolver.new(a, b, c)

    # solvable since gcd(12, 15) == 3 &amp;&amp; 99 % 3 == 0
    assert solver.solvable?

    x, y = solver.base_solution
    assert_equal c, a*x + b*y

    (-10..10).each do |k|
      x, y = solver.solution(k)
      assert_equal c, a*x + b*y
    end
  end

  def test_unsolvable_equation
    a, b, c = 12, 15, 100
    solver = LinearEquationSolver.new(a, b, c)

    # not solvable since gcd(a, b) == 3 &amp;&amp; 100 % 3 == 1
    assert !solver.solvable?

    assert_nil solver.base_solution
    (-10..10).each { |k| assert_nil solver.solution(k) }
  end
</code></pre>
<p><button class="fa fa-expand" onClick="showContent('linear-equation-solver')"></button></p>
<div id="linear-equation-solver" style="display: none;">
<pre><code class="language-ruby">class LinearEquationSolver
  # class to find integer solutions [x, y] to a*x + b*y == c

  def initialize(a, b, c)
    @a = a
    @b = b
    @c = c

    @d = gcd(a, b)
    @delta_x = b / @d
    @delta_y = -a / @d
    @multiplier, @remainder = div_rem(c, @d)
  end

  def solvable?
    @remainder == 0
  end

  # solution from bezout's identity, if it exists
  def base_solution
    @base_solution ||= bezout(@a, @b).map { |z| z * @multiplier } if solvable?
  end

  # solutions parametrized by an integer k
  def solution(k)
    if solvable?
      x, y = base_solution
      [x + @delta_x * k, y + @delta_y * k]
    end
  end
end
</code></pre>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        
        <script src="ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>
        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="js/additional.js"></script>
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>
        
        

    </body>
</html>
