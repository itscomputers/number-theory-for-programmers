<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>bezout's identity - number theory for programmers</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../sections/divisibility.html"><strong aria-hidden="true">1.</strong> divisibility</a></li><li class="chapter-item expanded "><a href="../sections/division_with_remainder.html"><strong aria-hidden="true">2.</strong> division with remainder</a></li><li class="chapter-item expanded "><a href="../sections/greatest_common_divisor.html"><strong aria-hidden="true">3.</strong> greatest common divisor</a></li><li class="chapter-item expanded "><a href="../sections/bezouts_identity.html" class="active"><strong aria-hidden="true">4.</strong> bezout's identity</a></li><li class="chapter-item expanded "><a href="../sections/least_common_multiple.html"><strong aria-hidden="true">5.</strong> least common multiple</a></li><li class="chapter-item expanded "><a href="../sections/linear_equations.html"><strong aria-hidden="true">6.</strong> linear equations</a></li><li class="chapter-item expanded "><a href="../sections/prime_numbers.html"><strong aria-hidden="true">7.</strong> prime numbers</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">number theory for programmers</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#bezouts-identity" id="bezouts-identity">bezout's identity</a></h1>
<blockquote>
<p><strong>proposition 6 (Bezout's identity).</strong>
The greatest common divisor can always be expressed as a linear combination
of the two integers.  In other words, given two integers \( a \) and
\( b \), there exist integers \( x \) and \( y \) such that
\( ax + by = \gcd(a, b) \).</p>
</blockquote>
<p>The proof of this is constructive and most easily understood through a few
examples.</p>
<h2><a class="header" href="#example-1" id="example-1">example 1</a></h2>
<p>For example, if \( a = 322 \) and \( b = 70 \), Bezout's identity implies
that \( 322x + 70y = 14 \) for some integers \( x \) and \( y \).  Such
integers might be found by brute force.  In this case, a brute force search
might arrive at the solution \( (x, y) = (-2, 9) \).  However, the Euclidean
algorithm provides an efficient way to find a solution.</p>
<p>The first division yields \( 322 = 70(4) + 42 \) with a quotient of
\( q_0 = 4 \) and a remainder of \( r_0 = 42 \).  Solving for \( r_0 \)
gives \( 42 = 322 - 70(4) \).  In particular, we have shown that the
remainder \( r_0 \) can be expressed as a linear combination of \( 322 \)
and \( 70 \), namely \( r_0 = 322(1) + 70(-4) \).</p>
<p>The second division yields \( 70 = 42(1) + 28 \) with a quotient of
\( q_1 = 1 \) and a remainder of \( r_1 = 28 \).  Solving for
\( r_1 \) gives \( 28 = 70 - 42(1) \).  The linear combination for
\( r_0 = 42 \) may be substituted here and simplified to
\( 28 = -322 + 70(5) \). Therefore, the remainder
\( r_1 = 322(-1) + 70(5) \) is also a linear combination of the original two
integers.</p>
<p>The third division gives \( 42 = 28(1) + 14 \) with a quotient of
\( q_2 = 1 \) and a remainder of \( r_2 = 28 \).  The linear combinations
for \( r_0 = 42 \) and \( r_1 = 28 \) may be substituted into this
expression.  Then solving for the new remainder, it will simplify to
\( 14 = 322(2) + 70(-9) \), which is the solution to Bezout's identity
that was listed above.</p>
<p>These computations are summarized in the table below. In each of the first
three rows, the last column is how to express each remainder \( r \) as a
linear combination of the original \( a = 322 \) and \( b = 70 \), namely,
\( r = 322x + 70y \).  The last row verifies that the algorithm has
terminated, ie, that the gcd of \( 322 \) and \( 70 \) is the
second-to-last remainder \( 14 \).</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right">\( 322 \)</td><td align="right">\( 70 \)</td><td align="right">\( 42 \)</td><td align="right">\( 4 \)</td><td align="left">\( (1, -4) \)</td></tr>
<tr><td align="right">\( 70 \)</td><td align="right">\( 42 \)</td><td align="right">\( 28 \)</td><td align="right">\( 1 \)</td><td align="left">\( (-1, 5) \)</td></tr>
<tr><td align="right">\( 42 \)</td><td align="right">\( 28 \)</td><td align="right">\( 14 \)</td><td align="right">\( 1 \)</td><td align="left">\( (2, -9) \)</td></tr>
<tr><td align="right">\( 28 \)</td><td align="right">\( 14 \)</td><td align="right">\( 0 \)</td><td align="right">\( 2 \)</td><td align="left"></td></tr>
</tbody></table>
<p>We would like a programatic way to compute the \( (x, y) \) pairs as we go.
Suppose that on some row we have \( a' = b'q + r \) and that we have already
calculated that \( a' = 322 x_0 + 70 y_0 \) and
\( b' = 322 x_1 + 70 y_1 \).  We can substitute these expressions into the
division algorithm equation to get
\[ 322 x_0 + 70 y_0 = (322 x_1 + 70 y_1)q + r. \]
Solving for \( r \) and rearranging, we get
\[ r = 322 (x_0 - x_1 q) + 70(y_0 - y_1 q). \]</p>
<p>This is great news, because we can compute the the next \( (x, y) \)
pair from the previous two pairs.  The recursive relation for both \( x \)
and \( y \) can be expressed as
\[ u_2 = u_0 - u_1 \cdot q. \]
In other words, the <code>next_value = previous_value - current_value * quotient</code>.</p>
<p>To see this in action, we observe first that \( a = a(1) + b(0) \) and
\( b = a(0) + b(1) \), so the initial values for the \( (x, y) \) pairs
are \( (1, 0) \) and \( (0, 1) \).</p>
<p>The first quotient is \( q = 4 \), so the first \( (x, y) \) pair is
\[ (1, 0) - (0, 1) \cdot 4 = (1 - 0, 0 - 4) = (1, -4). \]
(Note that we used vector addition and scalar multiplication to express this
succinctly.)  The second quotient is \( q = 1 \), so the second pair is
\[ (0, 1) - (1, -4) \cdot 1 = (0 - 1, 1 + 4) = (-1, 5). \]
The third quotient is \( q = 1 \), so the third pair is
\[ (1, -4) - (-1, 5) \cdot 1 = (1 + 1, -4 - 5) = (2, -9). \]
Since the following remainder is \( 0 \), the algorithm terminates.</p>
<h2><a class="header" href="#example-2" id="example-2">example 2</a></h2>
<p>Here is another example to illustrate this process.  Suppose we want to
find a solution to \( 5831 x + 482 y = \gcd(5831, 482) \).  We seed our table
with the initial \( (x, y) \) pairs and with \( a \) and \( b \) as the
first &quot;remainders&quot;.</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 5831 \)</td><td align="right"></td><td align="left">\( (1, 0) \)</td></tr>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 482 \)</td><td align="right"></td><td align="left">\( (0, 1) \)</td></tr>
</tbody></table>
<p>The division of \( 5381 \) by \( 482 \) yields \( 5831 = 482(12) + 47 \).
Since the quotient is \( q = 12 \), we calculate the next \( (x, y) \) pair
to be
\[ (1, 0) - (0, 1) \cdot 12 = (1 - 0, 0 - 12) = (1, -12) \]
and we fill in the new row on the table.</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 5831 \)</td><td align="right"></td><td align="left">\( (1, 0) \)</td></tr>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 482 \)</td><td align="right"></td><td align="left">\( (0, 1) \)</td></tr>
<tr><td align="right">\( 5831 \)</td><td align="right">\( 482 \)</td><td align="right">\(47 \)</td><td align="right">\( 12 \)</td><td align="left">\( (1, -12) \)</td></tr>
</tbody></table>
<p>The division of \( 482 \) by \( 47 \) yields \( 482 = 47(10) + 12 \).
Since the quotient is \( q = 10 \), we calculate the next \( (x, y) \) pair
to be
\[ (0, 1) - (1, -12) \cdot 10 = (0 - 10, 1 + 120) = (-10, 121) \]
and we fill in the new row on the table.</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 5831 \)</td><td align="right"></td><td align="left">\( (1, 0) \)</td></tr>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 482 \)</td><td align="right"></td><td align="left">\( (0, 1) \)</td></tr>
<tr><td align="right">\( 5831 \)</td><td align="right">\( 482 \)</td><td align="right">\(47 \)</td><td align="right">\( 12 \)</td><td align="left">\( (1, -12) \)</td></tr>
<tr><td align="right">\( 482 \)</td><td align="right">\( 47 \)</td><td align="right">\(12 \)</td><td align="right">\( 10 \)</td><td align="left">\( (-10, 121) \)</td></tr>
</tbody></table>
<p>The division of \( 47 \) by \( 12 \) yields \( 47 = 12(3) + 11 \).  With
a quotient of \( q = 3 \), the next \( (x, y) \) pair is
\[ (1, -12) - (-10, 121) \cdot 3 = (1 + 30, -12 - 363) = (31, -375) \]
and we fill in the new row on the table.</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 5831 \)</td><td align="right"></td><td align="left">\( (1, 0) \)</td></tr>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 482 \)</td><td align="right"></td><td align="left">\( (0, 1) \)</td></tr>
<tr><td align="right">\( 5831 \)</td><td align="right">\( 482 \)</td><td align="right">\(47 \)</td><td align="right">\( 12 \)</td><td align="left">\( (1, -12) \)</td></tr>
<tr><td align="right">\( 482 \)</td><td align="right">\( 47 \)</td><td align="right">\(12 \)</td><td align="right">\( 10 \)</td><td align="left">\( (-10, 121) \)</td></tr>
<tr><td align="right">\( 47 \)</td><td align="right">\( 12 \)</td><td align="right">\(11 \)</td><td align="right">\( 3 \)</td><td align="left">\( (31, -375) \)</td></tr>
</tbody></table>
<p>The division of \( 12 \) by \( 11 \) yields \( 12 = 11(1) + 1 \).  With a
quotient of \( q = 1 \), the next pair is
\[ (-10, 121) - (31, -375) \cdot 1 = (-10 - 31, 121 + 375) = (-41, 496) \]
and we fill in the new row.</p>
<table><thead><tr><th align="right">\( a' \)</th><th align="right">\( b' \)</th><th align="right">\( r \)</th><th align="right">\( q \)</th><th align="left">\( (x, y) \)</th></tr></thead><tbody>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 5831 \)</td><td align="right"></td><td align="left">\( (1, 0) \)</td></tr>
<tr><td align="right"></td><td align="right"></td><td align="right">\( 482 \)</td><td align="right"></td><td align="left">\( (0, 1) \)</td></tr>
<tr><td align="right">\( 5831 \)</td><td align="right">\( 482 \)</td><td align="right">\(47 \)</td><td align="right">\( 12 \)</td><td align="left">\( (1, -12) \)</td></tr>
<tr><td align="right">\( 482 \)</td><td align="right">\( 47 \)</td><td align="right">\(12 \)</td><td align="right">\( 10 \)</td><td align="left">\( (-10, 121) \)</td></tr>
<tr><td align="right">\( 47 \)</td><td align="right">\( 12 \)</td><td align="right">\(11 \)</td><td align="right">\( 3 \)</td><td align="left">\( (31, -375) \)</td></tr>
<tr><td align="right">\( 12 \)</td><td align="right">\( 11 \)</td><td align="right">\(1 \)</td><td align="right">\( 1 \)</td><td align="left">\( (-41, 496) \)</td></tr>
</tbody></table>
<p>The final division of \( 11 \) by \( 1 \) yields \( 11 = 1(11) + 0 \).
With a remainder of \( 0 \), the algorithm has terminated.  The greatest
common divisor is \( \gcd(5831, 482) = 1 \) and \( (-41, 496) \) is a
solution to \( 5831 x + 482 y = 1 \).</p>
<h2><a class="header" href="#in-code" id="in-code">in code</a></h2>
<p>The examples above can be generalized into a constructive proof of Bezout's
identity -- the proof is an algorithm to produce a solution.</p>
<span id="bezout-algorithm" />
<blockquote>
<p><strong>Bezout algorithm for positive integers.</strong>
Given <em>positive</em> integers <code>a</code> and <code>b</code>, we want to find integers <code>x</code> and <code>y</code>
such that <code>a * x + b * y == gcd(a, b)</code>.  Initially set <code>prev = [1, 0]</code> and
<code>curr = [0, 1]</code>.</p>
<ol>
<li>If <code>b == 0</code>, return <code>prev</code>.</li>
<li>Calculate <code>q, r = div_rem(a, b)</code>.</li>
<li>Calculate <code>x = prev[0] - curr[0] * q</code> and <code>y = prev[1] - curr[1] * q</code>.</li>
<li>Replace <code>a, b</code> with <code>b, r</code>.</li>
<li>Replace <code>prev, curr</code> with <code>curr, [x, y]</code>.</li>
<li>Return to Step 1.</li>
</ol>
</blockquote>
<p>The algorithm needs to be adjusted slightly for zero or negative values.  Run
the algorithm described for various combinations of positive, negative, and
zero values, checking whether each resulting pair <code>x, y</code> actually satisfies
<code>a * x + b * y == gcd(a, b)</code>.</p>
<p>While exploring zero/negative values, there are 3 cases to consider:</p>
<ol>
<li>when the algorithm returns immediately, ie, when the original <code>b</code> is zero.</li>
<li>when the algorithm returns after one iteration, ie, when the first remainder
<code>r</code> is zero.</li>
<li>when the algorithm returns after two or more iterations.</li>
</ol>
<p>We seeded the algorithm initially with <code>prev = [1, 0]</code> and <code>curr = [0, 1]</code>.
We did this in order to express <code>a</code> and <code>b</code> in terms of themselves, ie,
<code>a == 1 * a + 0 * b</code> and <code>b == 0 * a + 1 * b</code>.  With two or more iterations,
the division algorithm guarantees that the remainder is positive, so the
calculated pair at that point gives a positive number <code>a * x + b * y</code>.
However, if the algorithm terminates during the first or second iteration, we
would return either <code>[1, 0]</code> or <code>[0, 1]</code>, in which case we may end up with
<code>a * x + b * y</code> as a negative value, which would be incorrect since the
greatest common divisor is always positive.</p>
<p>To account for this, we may need to negate the values of <code>prev</code> in Step 1
before returning.  Consider these two examples.</p>
<ol>
<li>
<p>Let <code>a = -10</code> and <code>b = 0</code>.  Since <code>b == 0</code>, we return the original
<code>prev = [1, 0]</code> immediately.  Notice that <code>1 * -10 + 0 * 0 == -10</code> while
<code>gcd(-10, 0) == 10</code>.  In this case, we need to return the original <code>prev</code>
but with negated values, ie, <code>[-1, 0]</code>.</p>
</li>
<li>
<p>Let <code>a = 10</code> and <code>b = -5</code>.  Since <code>b != 0</code>, we calculate <code>q = -2</code> and
<code>r = 0</code>.  When we return to Step 1, we have <code>new_b = r == 0</code>, so we return
<code>new_prev = curr == [0, 1]</code>.  Notice that <code>0 * 10 + 1 * -5 = -5</code> while
<code>gcd(10, -5) == 5</code>.  In this case, we need to return the <code>new_prev</code> but with
negated values, ie, <code>[0, -1]</code>.</p>
</li>
</ol>
<p>The conclusion is that Step 1 requires the following adjustment:</p>
<blockquote>
<ol>
<li>If <code>b == 0</code>, return <code>prev</code> if <code>a &gt; 0</code>, otherwise return <code>prev</code> with
negated values.</li>
</ol>
</blockquote>
<span id="bezout-exercise" />
<blockquote>
<p><strong>exercise.</strong>
Write a <code>bezout</code> function that takes integer inputs <code>(a, b)</code> and
produces integers <code>(x, y)</code> such that <code>a * x + b * y = gcd(a, b)</code>.</p>
</blockquote>
<p>Testing this function is very simple: regardless of the inputs, Bezout's
identity must be satisfied.  Make sure you include test inputs for the special
cases discussed above.</p>
<pre><code class="language-ruby">  def test_bezout
    test_inputs.each do |(a, b)|
      x, y = bezout(a, b)
      assert_equal gcd(a, b), a * x + b * y
    end
  end

  def test_bezout_explicit
    assert_nil bezout(0, 0)
  end
</code></pre>
<p><button class="fa fa-expand" onClick="showContent('bezout')"></button></p>
<div id="bezout" style="display: none;">
<pre><code class="language-ruby">def bezout(a, b)
  return if a == 0 &amp;&amp; b == 0

  prev, curr = [[1, 0], [0, 1]]

  while b != 0
    quo, rem = div_rem(a, b)
    nxt = [0, 1].map { |i| prev[i] - curr[i] * quo }

    a, b = b, rem
    prev, curr = curr, nxt
  end

  a &lt; 0 ? prev.map { |u| -u } : prev
end
</code></pre>
</div>
<h2><a class="header" href="#applications-of-bezouts-identity" id="applications-of-bezouts-identity">applications of bezout's identity</a></h2>
<p>Bezout's identity is a powerful tool since it gives a relationship between
integers to their greatest common divisor.  Some proofs can be vastly
simplified by leveraging this new capability.  Here are a few propositions
that can be proved using Bezout's identity.</p>
<blockquote>
<p><strong>proposition 9.</strong>
The greatest common divisor of two integers is divisible by any common
divisor.</p>
</blockquote>
<blockquote>
<p><em>proof</em>:
Let \( k \) be a common divisor of \( a, b \) and let \( d \) be their
greatest common divisor.  Bezout's lemma allows us to write \( ax + by = d \)
for some integers \( x, y \).  Since \( k \) divides both \( a \) and
\( b \), it divides the linear combination \( ax + by \), which is equal
to \( d \).</p>
</blockquote>
<span id="divides-product-but-prime-to-first" />
<blockquote>
<p><strong>proposition 10.</strong>
If an integer \( c \) divides a product \( ab \) and
\( \gcd(a, c) = 1 \), then \( c \) divides \( b \).</p>
</blockquote>
<blockquote>
<p><em>proof:</em>
Since \( \gcd(a, c) = 1 \), then we can write \( ax + cy = 1 \) for some
integers \( x, y \).  Multiplying both sides by \( b \), we get
\[ abx + bcy = b. \]
The first term is divisible by \( c \), since \( c \) is assumed to
divide the product \( ab \).  The second term is divisible by \( c \)
since \( c \) occurs in that term.  Therefore, their sum is divisible by
\( c \), which proves that \( b \) is divisible by
\( c \).</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../sections/greatest_common_divisor.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../sections/least_common_multiple.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../sections/greatest_common_divisor.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../sections/least_common_multiple.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        
        <script src="../ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="../editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>
        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="../js/additional.js"></script>
        

        

    </body>
</html>
